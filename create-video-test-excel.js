const XLSX = require('xlsx')
const path = require('path')

// ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูุน ุฑูุงุจุท ููุฏูู ูุชููุนุฉ
const testData = [
  {
    'ุงูุงุณู ุงููุงูู': 'ุฃุญูุฏ ูุญูุฏ ุนูู',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ': 'ุฃุญูุฏ ูุญูุฏ ุนูู',
    'ุงูุฌูุณูุฉ': 'ูุตุฑู',
    'ุงููุธููุฉ ุงููุทููุจุฉ': 'ุณุงุฆู',
    'ุงูุนูุฑ': '30',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ': 'ูุชุฒูุฌ',
    'ุนุฏุฏ ุงูุฃุทูุงู': '2',
    'ุงูุฑุงุชุจ ุงูุดูุฑู': '1500',
    'ูุฏุฉ ุงูุนูุฏ': '2 ุณูุฉ',
    'ุฑูู ุงูุฌูุงุฒ': 'A12345678',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ': '2025-12-31',
    'ุงูููุฏ ุงููุฑุฌุนู': 'REF-001',
    'ุฑุงุจุท ุงูููุฏูู': 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
    'ุงูุฏูุงูุฉ': 'ูุณูู',
    'ุงูุทูู': '175',
    'ุงููุฒู': '70',
    'ุงูููุงุฏุฉ': 'ููุชุงุฒ',
    'ุงูุนุฑุจูุฉ': 'ููุชุงุฒ',
    'ุงูุฅูุฌููุฒูุฉ': 'ุฌูุฏ'
  },
  {
    'ุงูุงุณู ุงููุงูู': 'ูุงุทูุฉ ุญุณู',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ': 'ูุงุทูุฉ ุญุณู',
    'ุงูุฌูุณูุฉ': 'ููุจูููุฉ',
    'ุงููุธููุฉ ุงููุทููุจุฉ': 'ุนุงููุฉ ููุฒููุฉ',
    'ุงูุนูุฑ': '28',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ': 'ุนุฒุจุงุก',
    'ุนุฏุฏ ุงูุฃุทูุงู': '0',
    'ุงูุฑุงุชุจ ุงูุดูุฑู': '1200',
    'ูุฏุฉ ุงูุนูุฏ': '2 ุณูุฉ',
    'ุฑูู ุงูุฌูุงุฒ': 'P87654321',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ': '2026-06-15',
    'ุงูููุฏ ุงููุฑุฌุนู': 'REF-002',
    'ููุฏูู': 'https://youtu.be/ScMzIvxBSi4',
    'ุงูุฏูุงูุฉ': 'ูุณูุญู',
    'ุงูุทูู': '160',
    'ุงููุฒู': '55',
    'ุงูุชูุธูู': 'ููุชุงุฒ',
    'ุงูุทุจุฎ ุงูุนุฑุจู': 'ุฌูุฏ',
    'ุฑุนุงูุฉ ุงูุฃุทูุงู': 'ููุชุงุฒ',
    'ุงูุนุฑุจูุฉ': 'ูุชูุณุท',
    'ุงูุฅูุฌููุฒูุฉ': 'ุฌูุฏ'
  },
  {
    'ุงูุงุณู ุงููุงูู': 'John Smith',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ': 'ุฌูู ุณููุซ',
    'ุงูุฌูุณูุฉ': 'ุฃูุฑููู',
    'ุงููุธููุฉ ุงููุทููุจุฉ': 'ูุฏุฑุณ ุฎุตูุตู',
    'ุงูุนูุฑ': '35',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ': 'ูุชุฒูุฌ',
    'ุนุฏุฏ ุงูุฃุทูุงู': '1',
    'ุงูุฑุงุชุจ ุงูุดูุฑู': '2000',
    'ูุฏุฉ ุงูุนูุฏ': '1 ุณูุฉ',
    'ุฑูู ุงูุฌูุงุฒ': 'US123456789',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ': '2027-03-20',
    'ุงูููุฏ ุงููุฑุฌุนู': 'REF-003',
    'Video URL': 'https://drive.google.com/file/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/view?usp=sharing',
    'ุงูุฏูุงูุฉ': 'ูุณูุญู',
    'ุงูุทูู': '180',
    'ุงููุฒู': '75',
    'ุชุนููู ุงูุฃุทูุงู': 'ููุชุงุฒ',
    'ุงูุนุฑุจูุฉ': 'ูุจุชุฏุฆ',
    'ุงูุฅูุฌููุฒูุฉ': 'ููุชุงุฒ'
  },
  {
    'ุงูุงุณู ุงููุงูู': 'Maria Santos',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ': 'ูุงุฑูุง ุณุงูุชูุณ',
    'ุงูุฌูุณูุฉ': 'ุจุฑุงุฒูููุฉ',
    'ุงููุธููุฉ ุงููุทููุจุฉ': 'ุทุจุงุฎุฉ',
    'ุงูุนูุฑ': '32',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ': 'ูุทููุฉ',
    'ุนุฏุฏ ุงูุฃุทูุงู': '1',
    'ุงูุฑุงุชุจ ุงูุดูุฑู': '1400',
    'ูุฏุฉ ุงูุนูุฏ': '2 ุณูุฉ',
    'ุฑูู ุงูุฌูุงุฒ': 'BR987654321',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ': '2025-09-10',
    'ุงูููุฏ ุงููุฑุฌุนู': 'REF-004',
    'Video': 'https://vimeo.com/123456789',
    'ุงูุฏูุงูุฉ': 'ูุณูุญู',
    'ุงูุทูู': '165',
    'ุงููุฒู': '60',
    'ุงูุทุจุฎ ุงูุนุฑุจู': 'ููุชุงุฒ',
    'ุงูุชูุธูู': 'ุฌูุฏ',
    'ุงูุนุฑุจูุฉ': 'ูุชูุณุท',
    'ุงูุฅูุฌููุฒูุฉ': 'ุฌูุฏ'
  },
  {
    'ุงูุงุณู ุงููุงูู': 'Ahmed Hassan',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ': 'ุฃุญูุฏ ุญุณู',
    'ุงูุฌูุณูุฉ': 'ุณูุฏุงูู',
    'ุงููุธููุฉ ุงููุทููุจุฉ': 'ุญุงุฑุณ ุฃูู',
    'ุงูุนูุฑ': '40',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ': 'ูุชุฒูุฌ',
    'ุนุฏุฏ ุงูุฃุทูุงู': '3',
    'ุงูุฑุงุชุจ ุงูุดูุฑู': '1300',
    'ูุฏุฉ ุงูุนูุฏ': '2 ุณูุฉ',
    'ุฑูู ุงูุฌูุงุฒ': 'SD456789123',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ': '2026-01-25',
    'ุงูููุฏ ุงููุฑุฌุนู': 'REF-005',
    'Video Link': 'https://drive.google.com/file/d/0987654321zyxwvutsrqponmlk/view?usp=sharing',
    'ุงูุฏูุงูุฉ': 'ูุณูู',
    'ุงูุทูู': '178',
    'ุงููุฒู': '80',
    'ุงูุนุฑุจูุฉ': 'ููุชุงุฒ',
    'ุงูุฅูุฌููุฒูุฉ': 'ูุจุชุฏุฆ'
  }
]

function createVideoTestExcel() {
  console.log('๐ ุฅูุดุงุก ููู Excel ุชุฌุฑูุจู ูุน ุฑูุงุจุท ุงูููุฏูู...')
  
  // ุฅูุดุงุก workbook ุฌุฏูุฏ
  const wb = XLSX.utils.book_new()
  
  // ุชุญููู ุงูุจูุงูุงุช ุฅูู worksheet
  const ws = XLSX.utils.json_to_sheet(testData)
  
  // ุฅุถุงูุฉ ุงูู worksheet ุฅูู ุงูู workbook
  XLSX.utils.book_append_sheet(wb, ws, 'ุงูุณูุฑ ุงูุฐุงุชูุฉ ูุน ุงูููุฏูููุงุช')
  
  // ุชุญุฏูุฏ ูุณุงุฑ ุงูููู
  const filePath = path.join(__dirname, 'test-cvs-with-videos.xlsx')
  
  // ุญูุธ ุงูููู
  XLSX.writeFile(wb, filePath)
  
  console.log(`โ ุชู ุฅูุดุงุก ุงูููู ุจูุฌุงุญ: ${filePath}`)
  console.log('\n๐ ูุญุชููุงุช ุงูููู:')
  console.log(`๐ ุนุฏุฏ ุงูุณูุฑ ุงูุฐุงุชูุฉ: ${testData.length}`)
  
  // ุชุญููู ุฃููุงุน ุงูููุฏูููุงุช
  const videoTypes = {
    youtube: 0,
    googleDrive: 0,
    vimeo: 0,
    other: 0
  }
  
  const videoColumns = ['ุฑุงุจุท ุงูููุฏูู', 'ููุฏูู', 'Video URL', 'Video', 'Video Link']
  
  testData.forEach((row, index) => {
    let videoUrl = null
    let videoColumn = null
    
    // ุงูุจุญุซ ุนู ุนููุฏ ุงูููุฏูู
    for (const col of videoColumns) {
      if (row[col]) {
        videoUrl = row[col]
        videoColumn = col
        break
      }
    }
    
    if (videoUrl) {
      console.log(`\n${index + 1}. ${row['ุงูุงุณู ุงููุงูู']}`)
      console.log(`   ๐บ ุนููุฏ ุงูููุฏูู: "${videoColumn}"`)
      console.log(`   ๐ ุฑุงุจุท ุงูููุฏูู: ${videoUrl}`)
      
      // ุชุตููู ููุน ุงูููุฏูู
      if (videoUrl.includes('youtube.com') || videoUrl.includes('youtu.be')) {
        videoTypes.youtube++
        console.log(`   ๐ฑ ููุน ุงูููุฏูู: YouTube`)
      } else if (videoUrl.includes('drive.google.com')) {
        videoTypes.googleDrive++
        console.log(`   ๐ฑ ููุน ุงูููุฏูู: Google Drive`)
      } else if (videoUrl.includes('vimeo.com')) {
        videoTypes.vimeo++
        console.log(`   ๐ฑ ููุน ุงูููุฏูู: Vimeo`)
      } else {
        videoTypes.other++
        console.log(`   ๐ฑ ููุน ุงูููุฏูู: ุฃุฎุฑู`)
      }
    }
  })
  
  console.log('\n๐ ุฅุญุตุงุฆูุงุช ุงูููุฏูููุงุช:')
  console.log(`๐ฌ YouTube: ${videoTypes.youtube}`)
  console.log(`๐พ Google Drive: ${videoTypes.googleDrive}`)
  console.log(`๐ญ Vimeo: ${videoTypes.vimeo}`)
  console.log(`๐ ุฃุฎุฑู: ${videoTypes.other}`)
  
  console.log('\n๐ก ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:')
  console.log('1. ุงุฑูุน ุงูููู test-cvs-with-videos.xlsx ูู ุงูุฏุงุดุจูุฑุฏ')
  console.log('2. ุงุณุชุฎุฏู ุงูุงุณุชูุฑุงุฏ ุงูุฐูู')
  console.log('3. ุชุญูู ูู ุธููุฑ ุฃุฒุฑุงุฑ ุงูููุฏูู ูู ุตูุญุงุช ุงูุณููุฒ')
  console.log('4. ุงุถุบุท ุนูู ุฃุฒุฑุงุฑ ุงูููุฏูู ููุชุฃูุฏ ูู ุนูููุง')
  
  return filePath
}

// ุชุดุบูู ุงูุฏุงูุฉ
try {
  const filePath = createVideoTestExcel()
  console.log('\n๐ ุชู ุฅูุดุงุก ููู ุงูุงุฎุชุจุงุฑ ุจูุฌุงุญ!')
  console.log(`๐ ูุณุงุฑ ุงูููู: ${filePath}`)
} catch (error) {
  console.error('โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูููู:', error)
}
